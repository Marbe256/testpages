title:第3章 遠い記憶の採掘

やがて時は過ぎ、学生を卒業し、就職し、結婚し、子供が生まれ、毎日が日々の生活に追われるようになった。
引越も度重なり、学生の頃に見つけた関係式のメモもどこに行ったか分からず探せずにいた。
つい先日のことです。学生の頃のノート類が入った引越しの段ボールを確認したらメモが出てきた。
6乗まではが書かれていたが、7乗については完成していなかった。
7乗は6乗まで違いはなかなか解けなかったのです。

最近のことですが7乗が解けました。
計算は大変でしたが、愚直に解いただけです。
そして、6乗までとの違いがはっきり見えました。

$\sum (n-k)^3 k^3$ に注目する。右辺を計算する。
$$\sum (n-k)^3 k^3 = \sum (n^3 - 3n^2 k + 3nk^2 - k^3)k^3 = n^3 \sum k^3 - 3n^2 \sum k^4 + 3n \sum k^5 - \sum k^6 = \frac{n^7}{140} + \frac{n^3}{60} - \frac{n}{42}$$
$n^7$ について解く。
$$
 n^7 = \frac{10n}{3} - \frac{7n^3}{3} + \frac{7!}{3!3!} \sum (n-k)^3 k^3
$$
ということで、解けました。
$\frac{10n}{3} - \frac{7n^3}{3}$ という、なんか癖のある項があるので、難かしくなかなか解けなかったのです。

べき乗和については、以下に補足。
7乗の1階差分の式を考えます。
$$ (k+1)^7 - k^7 = 1 + 7k + 21k^2 + 35k^3 + 35k^4 + 21k^5 + 7k^6 $$
$k=1, 2, \dots, n-1$ まで並べます。
$$ 2^7 - 1^7     = 1 + 7 \cdot 2 + 21 \cdot 2^2 + 35 \cdot 2^3 + 35 \cdot 2^4 + 21 \cdot 2^5 + 7 \cdot 2^6  3^7 - 2^7     = 1 + 7 \cdot 3 + 21 \cdot 3^2 + 35 \cdot 3^3 + 35 \cdot 3^4 + 21 \cdot 3^5 + 7 \cdot 3^6  \dots   n^7 - (n-1)^7 = 1 + 7 \cdot 1 + 21 \cdot 1^2 + 35 \cdot 1^3 + 35 \cdot 1^4 + 21 \cdot 1^5 + 7 \cdot 1^6$$
すべて足すと。
$$ n^7 - 1^7 = (n-1) + 7 \sum k + 21 \sum k^2 + 35 \sum k^3 + 35 \sum k^4 + 21 \sum k^5 + 7 \sum k^6 \quad (k=1 \dots n-1) $$
右辺を計算すると、左辺と等しくなる。
（べき乗和については、これまでの計算結果を参照。$\sum k^5$ についても6乗の1階差分から導出できる。）
（最近調べて知ったのですが、ベルヌーイの多項式でべき乗和を参照するとよい。先人は素晴らしい…。）

そして、Pythonを使って文字式を計算することを知りました。
少し前にも、マセマティカ(Mathmatica)やサイラボ(Scilab)で色々と計算できることは知って、
スゲーって感動していました。でも、文字式の計算に使うことを考えてなかった。
今回、Pythonをつかって文字式を計算することができて、再びスゲーってなってます。
途中式がなく結果しかわかりませんが、それでも計算の結果は正確です。
計算方法はこんな感じです。
>>> from sympy import *
>>> n = Symbol('n')
>>> k = Symbol('k')
>>> expand(summation(k**3*(n-k)**3,(k,1,n)))
n**7/140 + n**3/60 - n/42

>>> expand(summation(n**3*k**3,(k,1,n-1)) - summation(3*n**2*k**4,(k,1,n-1)) + summation(3*n*k**5,(k,1,n-1)) - summation(k**6,(k,1,n-1)) ) 
n**7/140 + n**3/60 - n/42

式の入力の仕方は、少し独特ですがちゃんと計算してくれます。
Σもsummation()で計算して素晴らしい。

つぎに、$\sum k^6$ に注目する。$\sum k^6$ は $\sum (n-k)^6$ でもあるので、
$$ \sum k^6 = \sum (n-k)^6 \quad (k=1 \dots n-1) \\
          = \sum (n-k)^3 \cdot (n-k)^3 \\
          = \sum (n^3 - 3n^2k - 3nk^2 - k^3) \cdot (n-k)^3 \\
          = n^3 \sum (n-k)^3 - 3n^2 \sum (n-k)^3 k - 3n \sum (n-k)^3 k^2 - \sum (n-k)^3 k^3 \\
          = n^3 \sum k^3 - 3n^2 \sum (n-k)k^3 - 3n \sum (n-k)^2 k^3 - \sum (n-k)^3 k^3
$$
近道します。

6乗について検討してみる。
5乗の場合は、
$$ n^5 = n + \frac{5!}{4} \sum (n-k)^2 k^2 $$
両辺に $n$ をかけると、
$$ n^6 = n^2 + n \cdot \frac{5!}{4} \sum (n-k)^2 k^2 $$
となる。
$\sum (n-k)^2 k^3$ について考察する。
$$
 \sum (n-k)^2 k^3 = \sum (n-k)^3 k^2 \\
                  = \sum (n-k)(n-k)^2 k^2 \\
                  = n \sum (n-k)^2 k^2 - \sum (n-k)^2 k^3 \\
                  = \frac{n}{2} \sum (n-k)^2 k^2
$$
$\sum (n-k)^2 k^2$ と $\sum (n-k)^2 k^3$ から
$$
 n^6 = n^2 + n \cdot \frac{5!}{4} \sum (n-k)^2 k^2 \\
     = n^2 + \frac{5!}{2} \sum (n-k)^2 k^3 \\
     = n^2 + \frac{6!}{12} \sum (n-k)^2 k^3
$$
となる。
分母の12に関しては2!x3!と関係がありそう。
6乗については、Σの式の性質を利用した方法で解を導いた。

1階差分について検討してみる。
$$ (k+1)^6 - k^6 = 1 + 6k + 15k^2 + 20k^3 + 15k^4 + 6k^5 $$
$k=1, 2, 3, 4, \dots, n-1$ を順に書くと、
$$
 2^6 - 1^6 = 1 + 6 \cdot 1 + 15 \cdot 1^2 + 20 \cdot 1^3 + 15 \cdot 1^4 + 6 \cdot 1^5 \\
 3^6 - 2^6 = 1 + 6 \cdot 2 + 15 \cdot 2^2 + 20 \cdot 2^3 + 15 \cdot 2^4 + 6 \cdot 2^5 \\
 4^6 - 3^6 = 1 + 6 \cdot 3 + 15 \cdot 3^2 + 20 \cdot 3^3 + 15 \cdot 3^4 + 6 \cdot 3^5 \\
 &\dots \\
 n^6 - (n-1)^6 = 1 + 6(n-1) + 15(n-1)^2 + 20(n-1)^3 + 15(n-1)^4 + 6(n-1)^5
$$
上の式の総和は、
$$
 n^6 - 1^6 = (n-1) + 6 \sum k + 15 \sum k^2 + 20 \sum k^3 + 15 \sum k^4 + 6 \sum k^5 \quad (k=1 \dots n-1) \\
 6 \sum k^5 = n^6 - ( n + 6 \sum k + 15 \sum k^2 + 20 \sum k^3 + 15 \sum k^4 )
$$
           